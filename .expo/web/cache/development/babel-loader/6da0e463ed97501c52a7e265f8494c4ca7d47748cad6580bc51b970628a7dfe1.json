{"ast":null,"code":"'use strict';\n\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { registerWorkletStackDetails } from \"./errors.js\";\nimport { isSynchronizable } from \"./isSynchronizable.js\";\nimport { logger } from \"./logger.js\";\nimport { SHOULD_BE_USE_WEB } from \"./PlatformChecker/index.js\";\nimport { serializableMappingCache, serializableMappingFlag } from \"./serializableMappingCache.js\";\nimport { jsVersion } from \"./utils/jsVersion.js\";\nimport { isWorkletFunction } from \"./workletFunction.js\";\nimport { WorkletsError } from \"./WorkletsError.js\";\nimport { WorkletsModule } from \"./WorkletsModule/index.js\";\nvar MAGIC_KEY = 'REANIMATED_MAGIC_KEY';\nvar _worklet_12782560500969_init_data = {\n  code: \"function isHostObject_serializableJs1(value){const{MAGIC_KEY}=this.__closure;return MAGIC_KEY in value;}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"isHostObject_serializableJs1\\\",\\\"value\\\",\\\"MAGIC_KEY\\\",\\\"__closure\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AAiBA,SAAAA,4BAA6BA,CAAAC,KAAA,QAAAC,SAAA,OAAAC,SAAA,CAO3B,MAAO,CAAAD,SAAS,GAAI,CAAAD,KAAK,CAC3B\\\",\\\"ignoreList\\\":[]}\"\n};\nvar isHostObject = function isHostObject_serializableJs1Factory(_ref) {\n  var _worklet_12782560500969_init_data = _ref._worklet_12782560500969_init_data,\n    MAGIC_KEY = _ref.MAGIC_KEY;\n  var _e = [new global.Error(), -2, -27];\n  var isHostObject = function isHostObject(value) {\n    return MAGIC_KEY in value;\n  };\n  isHostObject.__closure = {\n    MAGIC_KEY: MAGIC_KEY\n  };\n  isHostObject.__workletHash = 12782560500969;\n  isHostObject.__pluginVersion = \"0.5.2\";\n  isHostObject.__initData = _worklet_12782560500969_init_data;\n  isHostObject.__stackDetails = _e;\n  return isHostObject;\n}({\n  _worklet_12782560500969_init_data: _worklet_12782560500969_init_data,\n  MAGIC_KEY: MAGIC_KEY\n});\nexport function isSerializableRef(value) {\n  return typeof value === 'object' && value !== null && '__serializableRef' in value;\n}\nvar _worklet_10518649607857_init_data = {\n  code: \"function isPlainJSObject_serializableJs2(object){return Object.getPrototypeOf(object)===Object.prototype;}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"isPlainJSObject_serializableJs2\\\",\\\"object\\\",\\\"Object\\\",\\\"getPrototypeOf\\\",\\\"prototype\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AA6BA,SAAAA,+BAAiCA,CAAAC,MAAA,EAG/B,MAAO,CAAAC,MAAM,CAACC,cAAc,CAACF,MAAM,CAAC,GAAKC,MAAM,CAACE,SAAS,CAC3D\\\",\\\"ignoreList\\\":[]}\"\n};\nvar isPlainJSObject = function isPlainJSObject_serializableJs2Factory(_ref2) {\n  var _worklet_10518649607857_init_data = _ref2._worklet_10518649607857_init_data;\n  var _e = [new global.Error(), 1, -27];\n  var isPlainJSObject = function isPlainJSObject(object) {\n    return Object.getPrototypeOf(object) === Object.prototype;\n  };\n  isPlainJSObject.__closure = {};\n  isPlainJSObject.__workletHash = 10518649607857;\n  isPlainJSObject.__pluginVersion = \"0.5.2\";\n  isPlainJSObject.__initData = _worklet_10518649607857_init_data;\n  isPlainJSObject.__stackDetails = _e;\n  return isPlainJSObject;\n}({\n  _worklet_10518649607857_init_data: _worklet_10518649607857_init_data\n});\nfunction isTurboModuleLike(object) {\n  return isHostObject(Object.getPrototypeOf(object));\n}\nfunction getFromCache(value) {\n  var cached = serializableMappingCache.get(value);\n  if (cached === serializableMappingFlag) {\n    return value;\n  }\n  return cached;\n}\nvar _worklet_10679603231779_init_data = {\n  code: \"function serializableJs3(){return new Proxy({},{get:function(_,prop){if(prop==='_isReanimatedSharedValue'||prop==='__remoteFunction'){return false;}throw new WorkletsError(\\\"Trying to access property `\\\"+String(prop)+\\\"` of an object which cannot be sent to the UI runtime.\\\");},set:function(){throw new WorkletsError('Trying to write to an object which cannot be sent to the UI runtime.');}});}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"serializableJs3\\\",\\\"Proxy\\\",\\\"get\\\",\\\"_\\\",\\\"prop\\\",\\\"WorkletsError\\\",\\\"String\\\",\\\"set\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AAsDU,SAAAA,eAAMA,CAAA,EAGZ,MAAO,IAAI,CAAAC,KAAK,CAAC,CAAC,CAAC,CAAE,CACnBC,GAAG,CAAE,QAAAA,CAACC,CAAC,CAAEC,IAAI,CAAK,CAChB,GAAIA,IAAI,GAAK,0BAA0B,EAAIA,IAAI,GAAK,kBAAkB,CAAE,CAStE,MAAO,MAAK,CACd,CACA,KAAM,IAAI,CAAAC,aAAa,+BAAgCC,MAAM,CAACF,IAAI,CAAC,yDAAyD,CAAC,CAC/H,CAAC,CACDG,GAAG,CAAE,QAAAA,CAAA,CAAM,CACT,KAAM,IAAI,CAAAF,aAAa,CAAC,sEAAsE,CAAC,CACjG,CACF,CAAC,CAAC,CACJ\\\",\\\"ignoreList\\\":[]}\"\n};\nvar INACCESSIBLE_OBJECT = {\n  __init: function serializableJs3Factory(_ref3) {\n    var _worklet_10679603231779_init_data = _ref3._worklet_10679603231779_init_data;\n    var _e = [new global.Error(), 1, -27];\n    var serializableJs3 = function serializableJs3() {\n      return new Proxy({}, {\n        get: function get(_, prop) {\n          if (prop === '_isReanimatedSharedValue' || prop === '__remoteFunction') {\n            return false;\n          }\n          throw new WorkletsError(`Trying to access property \\`${String(prop)}\\` of an object which cannot be sent to the UI runtime.`);\n        },\n        set: function set() {\n          throw new WorkletsError('Trying to write to an object which cannot be sent to the UI runtime.');\n        }\n      });\n    };\n    serializableJs3.__closure = {};\n    serializableJs3.__workletHash = 10679603231779;\n    serializableJs3.__pluginVersion = \"0.5.2\";\n    serializableJs3.__initData = _worklet_10679603231779_init_data;\n    serializableJs3.__stackDetails = _e;\n    return serializableJs3;\n  }({\n    _worklet_10679603231779_init_data: _worklet_10679603231779_init_data\n  })\n};\nvar VALID_ARRAY_VIEWS_NAMES = ['Int8Array', 'Uint8Array', 'Uint8ClampedArray', 'Int16Array', 'Uint16Array', 'Int32Array', 'Uint32Array', 'Float32Array', 'Float64Array', 'BigInt64Array', 'BigUint64Array', 'DataView'];\nvar DETECT_CYCLIC_OBJECT_DEPTH_THRESHOLD = 30;\nvar processedObjectAtThresholdDepth;\nfunction createSerializableWeb(value) {\n  return value;\n}\nfunction createSerializableNative(value) {\n  var shouldPersistRemote = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  detectCyclicObject(value, depth);\n  var isObject = typeof value === 'object';\n  var isFunction = typeof value === 'function';\n  if (typeof value === 'string') {\n    return cloneString(value);\n  }\n  if (typeof value === 'number') {\n    return cloneNumber(value);\n  }\n  if (typeof value === 'boolean') {\n    return cloneBoolean(value);\n  }\n  if (typeof value === 'bigint') {\n    return cloneBigInt(value);\n  }\n  if (value === undefined) {\n    return cloneUndefined();\n  }\n  if (value === null) {\n    return cloneNull();\n  }\n  if (!isObject && !isFunction || value === null) {\n    return clonePrimitive(value, shouldPersistRemote);\n  }\n  var cached = getFromCache(value);\n  if (cached !== undefined) {\n    return cached;\n  }\n  if (Array.isArray(value)) {\n    return cloneArray(value, shouldPersistRemote, depth);\n  }\n  if (globalThis._WORKLETS_BUNDLE_MODE && isFunction && value.__bundleData) {\n    return cloneImport(value);\n  }\n  if (isFunction && !isWorkletFunction(value)) {\n    return cloneRemoteFunction(value);\n  }\n  if (isTurboModuleLike(value)) {\n    return cloneTurboModuleLike(value, shouldPersistRemote, depth);\n  }\n  if (isHostObject(value)) {\n    return cloneHostObject(value);\n  }\n  if (isPlainJSObject(value) && value.__init) {\n    return cloneInitializer(value, shouldPersistRemote, depth);\n  }\n  if (isPlainJSObject(value) && value.__workletContextObjectFactory) {\n    return cloneContextObject(value);\n  }\n  if ((isPlainJSObject(value) || isFunction) && isWorkletFunction(value)) {\n    return cloneWorklet(value, shouldPersistRemote, depth);\n  }\n  if (isSynchronizable(value)) {\n    return cloneSynchronizable(value);\n  }\n  if (isPlainJSObject(value) || isFunction) {\n    return clonePlainJSObject(value, shouldPersistRemote, depth);\n  }\n  if (value instanceof Set) {\n    return cloneSet(value);\n  }\n  if (value instanceof Map) {\n    return cloneMap(value);\n  }\n  if (value instanceof RegExp) {\n    return cloneRegExp(value);\n  }\n  if (value instanceof Error) {\n    return cloneError(value);\n  }\n  if (value instanceof ArrayBuffer) {\n    return cloneArrayBuffer(value, shouldPersistRemote);\n  }\n  if (ArrayBuffer.isView(value)) {\n    return cloneArrayBufferView(value);\n  }\n  return inaccessibleObject(value);\n}\nif (globalThis._WORKLETS_BUNDLE_MODE) {\n  createSerializableNative.__bundleData = {\n    imported: 'createSerializable',\n    source: require.resolveWeak('./index')\n  };\n}\nexport var createSerializable = SHOULD_BE_USE_WEB ? createSerializableWeb : createSerializableNative;\nfunction detectCyclicObject(value, depth) {\n  if (depth >= DETECT_CYCLIC_OBJECT_DEPTH_THRESHOLD) {\n    if (depth === DETECT_CYCLIC_OBJECT_DEPTH_THRESHOLD) {\n      processedObjectAtThresholdDepth = value;\n    } else if (value === processedObjectAtThresholdDepth) {\n      throw new WorkletsError('Trying to convert a cyclic object to a serializable. This is not supported.');\n    }\n  } else {\n    processedObjectAtThresholdDepth = undefined;\n  }\n}\nfunction clonePrimitive(value, shouldPersistRemote) {\n  return WorkletsModule.createSerializable(value, shouldPersistRemote);\n}\nfunction cloneString(value) {\n  return WorkletsModule.createSerializableString(value);\n}\nfunction cloneNumber(value) {\n  return WorkletsModule.createSerializableNumber(value);\n}\nfunction cloneBoolean(value) {\n  return WorkletsModule.createSerializableBoolean(value);\n}\nfunction cloneBigInt(value) {\n  return WorkletsModule.createSerializableBigInt(value);\n}\nfunction cloneUndefined() {\n  return WorkletsModule.createSerializableUndefined();\n}\nfunction cloneNull() {\n  return WorkletsModule.createSerializableNull();\n}\nfunction cloneObjectProperties(value, shouldPersistRemote, depth) {\n  var clonedProps = {};\n  for (var _ref4 of Object.entries(value)) {\n    var _ref5 = _slicedToArray(_ref4, 2);\n    var key = _ref5[0];\n    var element = _ref5[1];\n    if (key === '__initData' && clonedProps.__initData !== undefined) {\n      continue;\n    }\n    clonedProps[key] = createSerializable(element, shouldPersistRemote, depth + 1);\n  }\n  return clonedProps;\n}\nfunction cloneInitializer(value) {\n  var shouldPersistRemote = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var clonedProps = cloneObjectProperties(value, shouldPersistRemote, depth);\n  return WorkletsModule.createSerializableInitializer(clonedProps);\n}\nfunction cloneArray(value, shouldPersistRemote, depth) {\n  var clonedElements = value.map(function (element) {\n    return createSerializable(element, shouldPersistRemote, depth + 1);\n  });\n  var clone = WorkletsModule.createSerializableArray(clonedElements, shouldPersistRemote);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  freezeObjectInDev(value);\n  return clone;\n}\nfunction cloneRemoteFunction(value) {\n  var clone = WorkletsModule.createSerializableFunction(value);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  freezeObjectInDev(value);\n  return clone;\n}\nfunction cloneHostObject(value) {\n  var clone = WorkletsModule.createSerializableHostObject(value);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  return clone;\n}\nfunction cloneWorklet(value, shouldPersistRemote, depth) {\n  if (__DEV__) {\n    var babelVersion = value.__pluginVersion;\n    if (babelVersion !== undefined && babelVersion !== jsVersion) {\n      throw new WorkletsError(`Mismatch between JavaScript code version and Worklets Babel plugin version (${jsVersion} vs. ${babelVersion}).\n    See \\`https://docs.swmansion.com/react-native-worklets/docs/guides/troubleshooting#mismatch-between-javascript-code-version-and-worklets-babel-plugin-version\\` for more details.\n    Offending code was: \\`${getWorkletCode(value)}\\``);\n    }\n    registerWorkletStackDetails(value.__workletHash, value.__stackDetails);\n  }\n  if (value.__stackDetails) {\n    delete value.__stackDetails;\n  }\n  var clonedProps = cloneObjectProperties(value, true, depth);\n  clonedProps.__initData = createSerializable(value.__initData, true, depth + 1);\n  var clone = WorkletsModule.createSerializableWorklet(clonedProps, true);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  freezeObjectInDev(value);\n  return clone;\n}\nfunction cloneTurboModuleLike(value, shouldPersistRemote, depth) {\n  var proto = Object.getPrototypeOf(value);\n  var clonedProps = cloneObjectProperties(value, shouldPersistRemote, depth);\n  var clone = WorkletsModule.createSerializableTurboModuleLike(clonedProps, proto);\n  return clone;\n}\nvar _worklet_6111457967290_init_data = {\n  code: \"function serializableJs4(){const{workletContextObjectFactory}=this.__closure;return workletContextObjectFactory();}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"serializableJs4\\\",\\\"workletContextObjectFactory\\\",\\\"__closure\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AA8SY,SAAAA,eAAMA,CAAA,QAAAC,2BAAA,OAAAC,SAAA,CAGZ,MAAO,CAAAD,2BAA2B,CAAC,CAAC,CACtC\\\",\\\"ignoreList\\\":[]}\"\n};\nfunction cloneContextObject(value) {\n  var workletContextObjectFactory = value.__workletContextObjectFactory;\n  var handle = cloneInitializer({\n    __init: function serializableJs4Factory(_ref6) {\n      var _worklet_6111457967290_init_data = _ref6._worklet_6111457967290_init_data,\n        workletContextObjectFactory = _ref6.workletContextObjectFactory;\n      var _e = [new global.Error(), -2, -27];\n      var serializableJs4 = function serializableJs4() {\n        return workletContextObjectFactory();\n      };\n      serializableJs4.__closure = {\n        workletContextObjectFactory: workletContextObjectFactory\n      };\n      serializableJs4.__workletHash = 6111457967290;\n      serializableJs4.__pluginVersion = \"0.5.2\";\n      serializableJs4.__initData = _worklet_6111457967290_init_data;\n      serializableJs4.__stackDetails = _e;\n      return serializableJs4;\n    }({\n      _worklet_6111457967290_init_data: _worklet_6111457967290_init_data,\n      workletContextObjectFactory: workletContextObjectFactory\n    })\n  });\n  serializableMappingCache.set(value, handle);\n  return handle;\n}\nfunction clonePlainJSObject(value, shouldPersistRemote, depth) {\n  var clonedProps = cloneObjectProperties(value, shouldPersistRemote, depth);\n  var clone = WorkletsModule.createSerializableObject(clonedProps, shouldPersistRemote, value);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  freezeObjectInDev(value);\n  return clone;\n}\nfunction cloneMap(value) {\n  var clonedKeys = [];\n  var clonedValues = [];\n  for (var _ref7 of value.entries()) {\n    var _ref8 = _slicedToArray(_ref7, 2);\n    var key = _ref8[0];\n    var element = _ref8[1];\n    clonedKeys.push(createSerializable(key));\n    clonedValues.push(createSerializable(element));\n  }\n  var clone = WorkletsModule.createSerializableMap(clonedKeys, clonedValues);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  freezeObjectInDev(value);\n  return clone;\n}\nfunction cloneSet(value) {\n  var clonedElements = [];\n  for (var element of value) {\n    clonedElements.push(createSerializable(element));\n  }\n  var clone = WorkletsModule.createSerializableSet(clonedElements);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  freezeObjectInDev(value);\n  return clone;\n}\nvar _worklet_15891395326778_init_data = {\n  code: \"function serializableJs5(){const{pattern,flags}=this.__closure;return new RegExp(pattern,flags);}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"serializableJs5\\\",\\\"pattern\\\",\\\"flags\\\",\\\"__closure\\\",\\\"RegExp\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AA2VY,SAAAA,eAAMA,CAAA,QAAAC,OAAA,CAAAC,KAAA,OAAAC,SAAA,CAGZ,MAAO,IAAI,CAAAC,MAAM,CAACH,OAAO,CAAEC,KAAK,CAAC,CACnC\\\",\\\"ignoreList\\\":[]}\"\n};\nfunction cloneRegExp(value) {\n  var pattern = value.source;\n  var flags = value.flags;\n  var handle = cloneInitializer({\n    __init: function serializableJs5Factory(_ref9) {\n      var _worklet_15891395326778_init_data = _ref9._worklet_15891395326778_init_data,\n        pattern = _ref9.pattern,\n        flags = _ref9.flags;\n      var _e = [new global.Error(), -3, -27];\n      var serializableJs5 = function serializableJs5() {\n        return new RegExp(pattern, flags);\n      };\n      serializableJs5.__closure = {\n        pattern: pattern,\n        flags: flags\n      };\n      serializableJs5.__workletHash = 15891395326778;\n      serializableJs5.__pluginVersion = \"0.5.2\";\n      serializableJs5.__initData = _worklet_15891395326778_init_data;\n      serializableJs5.__stackDetails = _e;\n      return serializableJs5;\n    }({\n      _worklet_15891395326778_init_data: _worklet_15891395326778_init_data,\n      pattern: pattern,\n      flags: flags\n    })\n  });\n  serializableMappingCache.set(value, handle);\n  return handle;\n}\nvar _worklet_15256067994573_init_data = {\n  code: \"function serializableJs6(){const{name,message,stack}=this.__closure;const error=new Error();error.name=name;error.message=message;error.stack=stack;return error;}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"serializableJs6\\\",\\\"name\\\",\\\"message\\\",\\\"stack\\\",\\\"__closure\\\",\\\"error\\\",\\\"Error\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AA2WY,SAAAA,eAAMA,CAAA,QAAAC,IAAA,CAAAC,OAAA,CAAAC,KAAA,OAAAC,SAAA,CAIZ,KAAM,CAAAC,KAAK,CAAG,GAAI,CAAAC,KAAK,CAAC,CAAC,CACzBD,KAAK,CAACJ,IAAI,CAAGA,IAAI,CACjBI,KAAK,CAACH,OAAO,CAAGA,OAAO,CACvBG,KAAK,CAACF,KAAK,CAAGA,KAAK,CACnB,MAAO,CAAAE,KAAK,CACd\\\",\\\"ignoreList\\\":[]}\"\n};\nfunction cloneError(value) {\n  var name = value.name,\n    message = value.message,\n    stack = value.stack;\n  var handle = cloneInitializer({\n    __init: function serializableJs6Factory(_ref0) {\n      var _worklet_15256067994573_init_data = _ref0._worklet_15256067994573_init_data,\n        name = _ref0.name,\n        message = _ref0.message,\n        stack = _ref0.stack;\n      var _e = [new global.Error(), -4, -27];\n      var serializableJs6 = function serializableJs6() {\n        var error = new Error();\n        error.name = name;\n        error.message = message;\n        error.stack = stack;\n        return error;\n      };\n      serializableJs6.__closure = {\n        name: name,\n        message: message,\n        stack: stack\n      };\n      serializableJs6.__workletHash = 15256067994573;\n      serializableJs6.__pluginVersion = \"0.5.2\";\n      serializableJs6.__initData = _worklet_15256067994573_init_data;\n      serializableJs6.__stackDetails = _e;\n      return serializableJs6;\n    }({\n      _worklet_15256067994573_init_data: _worklet_15256067994573_init_data,\n      name: name,\n      message: message,\n      stack: stack\n    })\n  });\n  serializableMappingCache.set(value, handle);\n  return handle;\n}\nfunction cloneArrayBuffer(value, shouldPersistRemote) {\n  var clone = WorkletsModule.createSerializable(value, shouldPersistRemote, value);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  return clone;\n}\nvar _worklet_2505771972296_init_data = {\n  code: \"function serializableJs7(){const{VALID_ARRAY_VIEWS_NAMES,typeName,buffer}=this.__closure;if(!VALID_ARRAY_VIEWS_NAMES.includes(typeName)){throw new WorkletsError(\\\"Invalid array view name `\\\"+typeName+\\\"`.\\\");}const constructor=global[typeName];if(constructor===undefined){throw new WorkletsError(\\\"Constructor for `\\\"+typeName+\\\"` not found.\\\");}return new constructor(buffer);}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"serializableJs7\\\",\\\"VALID_ARRAY_VIEWS_NAMES\\\",\\\"typeName\\\",\\\"buffer\\\",\\\"__closure\\\",\\\"includes\\\",\\\"WorkletsError\\\",\\\"constructor\\\",\\\"global\\\",\\\"undefined\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AAmYY,SAAAA,eAAMA,CAAA,QAAAC,uBAAA,CAAAC,QAAA,CAAAC,MAAA,OAAAC,SAAA,CAGZ,GAAI,CAACH,uBAAuB,CAACI,QAAQ,CAACH,QAAQ,CAAC,CAAE,CAC/C,KAAM,IAAI,CAAAI,aAAa,6BAA8BJ,QAAQ,KAAK,CAAC,CACrE,CACA,KAAM,CAAAK,WAAW,CAAGC,MAAM,CAACN,QAAQ,CAAC,CACpC,GAAIK,WAAW,GAAKE,SAAS,CAAE,CAC7B,KAAM,IAAI,CAAAH,aAAa,qBAAsBJ,QAAQ,eAAe,CAAC,CACvE,CACA,MAAO,IAAI,CAAAK,WAAW,CAACJ,MAAM,CAAC,CAChC\\\",\\\"ignoreList\\\":[]}\"\n};\nfunction cloneArrayBufferView(value) {\n  var buffer = value.buffer;\n  var typeName = value.constructor.name;\n  var handle = cloneInitializer({\n    __init: function serializableJs7Factory(_ref1) {\n      var _worklet_2505771972296_init_data = _ref1._worklet_2505771972296_init_data,\n        VALID_ARRAY_VIEWS_NAMES = _ref1.VALID_ARRAY_VIEWS_NAMES,\n        typeName = _ref1.typeName,\n        buffer = _ref1.buffer;\n      var _e = [new global.Error(), -4, -27];\n      var serializableJs7 = function serializableJs7() {\n        if (!VALID_ARRAY_VIEWS_NAMES.includes(typeName)) {\n          throw new WorkletsError(`Invalid array view name \\`${typeName}\\`.`);\n        }\n        var constructor = global[typeName];\n        if (constructor === undefined) {\n          throw new WorkletsError(`Constructor for \\`${typeName}\\` not found.`);\n        }\n        return new constructor(buffer);\n      };\n      serializableJs7.__closure = {\n        VALID_ARRAY_VIEWS_NAMES: VALID_ARRAY_VIEWS_NAMES,\n        typeName: typeName,\n        buffer: buffer\n      };\n      serializableJs7.__workletHash = 2505771972296;\n      serializableJs7.__pluginVersion = \"0.5.2\";\n      serializableJs7.__initData = _worklet_2505771972296_init_data;\n      serializableJs7.__stackDetails = _e;\n      return serializableJs7;\n    }({\n      _worklet_2505771972296_init_data: _worklet_2505771972296_init_data,\n      VALID_ARRAY_VIEWS_NAMES: VALID_ARRAY_VIEWS_NAMES,\n      typeName: typeName,\n      buffer: buffer\n    })\n  });\n  serializableMappingCache.set(value, handle);\n  return handle;\n}\nfunction cloneSynchronizable(value) {\n  serializableMappingCache.set(value);\n  return value;\n}\nfunction cloneImport(value) {\n  var _value$__bundleData = value.__bundleData,\n    source = _value$__bundleData.source,\n    imported = _value$__bundleData.imported;\n  var clone = WorkletsModule.createSerializableImport(source, imported);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n  return clone;\n}\nfunction inaccessibleObject(value) {\n  var clone = createSerializable(INACCESSIBLE_OBJECT);\n  serializableMappingCache.set(value, clone);\n  return clone;\n}\nvar WORKLET_CODE_THRESHOLD = 255;\nfunction getWorkletCode(value) {\n  var _value$__initData;\n  var code = value == null ? void 0 : (_value$__initData = value.__initData) == null ? void 0 : _value$__initData.code;\n  if (!code) {\n    return 'unknown';\n  }\n  if (code.length > WORKLET_CODE_THRESHOLD) {\n    return `${code.substring(0, WORKLET_CODE_THRESHOLD)}...`;\n  }\n  return code;\n}\nvar _worklet_12661863896384_init_data = {\n  code: \"function isRemoteFunction_serializableJs8(value){return!!value.__remoteFunction;}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"isRemoteFunction_serializableJs8\\\",\\\"value\\\",\\\"__remoteFunction\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AAybA,SAAAA,gCAAiCA,CAAAC,KAAA,EAG/B,MAAO,CAAC,CAACA,KAAK,CAACC,gBAAgB,CACjC\\\",\\\"ignoreList\\\":[]}\"\n};\nvar isRemoteFunction = function isRemoteFunction_serializableJs8Factory(_ref10) {\n  var _worklet_12661863896384_init_data = _ref10._worklet_12661863896384_init_data;\n  var _e = [new global.Error(), 1, -27];\n  var isRemoteFunction = function isRemoteFunction(value) {\n    return !!value.__remoteFunction;\n  };\n  isRemoteFunction.__closure = {};\n  isRemoteFunction.__workletHash = 12661863896384;\n  isRemoteFunction.__pluginVersion = \"0.5.2\";\n  isRemoteFunction.__initData = _worklet_12661863896384_init_data;\n  isRemoteFunction.__stackDetails = _e;\n  return isRemoteFunction;\n}({\n  _worklet_12661863896384_init_data: _worklet_12661863896384_init_data\n});\nfunction freezeObjectInDev(value) {\n  if (!__DEV__) {\n    return;\n  }\n  Object.entries(value).forEach(function (_ref11) {\n    var _ref12 = _slicedToArray(_ref11, 2),\n      key = _ref12[0],\n      element = _ref12[1];\n    var descriptor = Object.getOwnPropertyDescriptor(value, key);\n    if (!descriptor.configurable) {\n      return;\n    }\n    Object.defineProperty(value, key, {\n      get: function get() {\n        return element;\n      },\n      set: function set() {\n        logger.warn(`Tried to modify key \\`${key}\\` of an object which has been already passed to a worklet. See\n        https://docs.swmansion.com/react-native-reanimated/docs/guides/troubleshooting#tried-to-modify-key-of-an-object-which-has-been-converted-to-a-serializable\n        for more details.`);\n      }\n    });\n  });\n  Object.preventExtensions(value);\n}\nvar _worklet_10155338524513_init_data = {\n  code: \"function makeShareableCloneOnUIRecursiveLEGACY_serializableJs9(value){const{SHOULD_BE_USE_WEB,isHostObject,isRemoteFunction}=this.__closure;if(SHOULD_BE_USE_WEB){return value;}function cloneRecursive(value){if(typeof value==='object'&&value!==null||typeof value==='function'){if(isHostObject(value)){return global._createSerializableHostObject(value);}if(isRemoteFunction(value)){return value.__remoteFunction;}if(Array.isArray(value)){return global._createSerializableArray(value.map(cloneRecursive));}if(value.__synchronizableRef){return global._createSerializableSynchronizable(value);}const toAdapt={};for(const[key,element]of Object.entries(value)){toAdapt[key]=cloneRecursive(element);}return global._createSerializable(toAdapt,value);}if(typeof value==='string'){return global._createSerializableString(value);}if(typeof value==='number'){return global._createSerializableNumber(value);}if(typeof value==='boolean'){return global._createSerializableBoolean(value);}if(typeof value==='bigint'){return global._createSerializableBigInt(value);}if(value===undefined){return global._createSerializableUndefined();}if(value===null){return global._createSerializableNull();}return global._createSerializable(value,undefined);}return cloneRecursive(value);}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"makeShareableCloneOnUIRecursiveLEGACY_serializableJs9\\\",\\\"value\\\",\\\"SHOULD_BE_USE_WEB\\\",\\\"isHostObject\\\",\\\"isRemoteFunction\\\",\\\"__closure\\\",\\\"cloneRecursive\\\",\\\"global\\\",\\\"_createSerializableHostObject\\\",\\\"__remoteFunction\\\",\\\"Array\\\",\\\"isArray\\\",\\\"_createSerializableArray\\\",\\\"map\\\",\\\"__synchronizableRef\\\",\\\"_createSerializableSynchronizable\\\",\\\"toAdapt\\\",\\\"key\\\",\\\"element\\\",\\\"Object\\\",\\\"entries\\\",\\\"_createSerializable\\\",\\\"_createSerializableString\\\",\\\"_createSerializableNumber\\\",\\\"_createSerializableBoolean\\\",\\\"_createSerializableBigInt\\\",\\\"undefined\\\",\\\"_createSerializableUndefined\\\",\\\"_createSerializableNull\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AAmeA,SAAAA,qDAAsDA,CAAAC,KAAA,QAAAC,iBAAA,CAAAC,YAAA,CAAAC,gBAAA,OAAAC,SAAA,CAGpD,GAAIH,iBAAiB,CAAE,CAGrB,MAAO,CAAAD,KAAK,CACd,CAEA,QAAS,CAAAK,cAAcA,CAACL,KAAK,CAAE,CAC7B,GAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,EAAIA,KAAK,GAAK,IAAI,EAAI,MAAO,CAAAA,KAAK,GAAK,UAAU,CAAE,CAC9E,GAAIE,YAAY,CAACF,KAAK,CAAC,CAAE,CAGvB,MAAO,CAAAM,MAAM,CAACC,6BAA6B,CAACP,KAAK,CAAC,CACpD,CACA,GAAIG,gBAAgB,CAACH,KAAK,CAAC,CAAE,CAI3B,MAAO,CAAAA,KAAK,CAACQ,gBAAgB,CAC/B,CACA,GAAIC,KAAK,CAACC,OAAO,CAACV,KAAK,CAAC,CAAE,CACxB,MAAO,CAAAM,MAAM,CAACK,wBAAwB,CAACX,KAAK,CAACY,GAAG,CAACP,cAAc,CAAC,CAAC,CACnE,CACA,GAAIL,KAAK,CAACa,mBAAmB,CAAE,CAC7B,MAAO,CAAAP,MAAM,CAACQ,iCAAiC,CAACd,KAAK,CAAC,CACxD,CACA,KAAM,CAAAe,OAAO,CAAG,CAAC,CAAC,CAClB,IAAK,KAAM,CAACC,GAAG,CAAEC,OAAO,CAAC,EAAI,CAAAC,MAAM,CAACC,OAAO,CAACnB,KAAK,CAAC,CAAE,CAClDe,OAAO,CAACC,GAAG,CAAC,CAAGX,cAAc,CAACY,OAAO,CAAC,CACxC,CACA,MAAO,CAAAX,MAAM,CAACc,mBAAmB,CAACL,OAAO,CAAEf,KAAK,CAAC,CACnD,CACA,GAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,CAC7B,MAAO,CAAAM,MAAM,CAACe,yBAAyB,CAACrB,KAAK,CAAC,CAChD,CACA,GAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,CAC7B,MAAO,CAAAM,MAAM,CAACgB,yBAAyB,CAACtB,KAAK,CAAC,CAChD,CACA,GAAI,MAAO,CAAAA,KAAK,GAAK,SAAS,CAAE,CAC9B,MAAO,CAAAM,MAAM,CAACiB,0BAA0B,CAACvB,KAAK,CAAC,CACjD,CACA,GAAI,MAAO,CAAAA,KAAK,GAAK,QAAQ,CAAE,CAC7B,MAAO,CAAAM,MAAM,CAACkB,yBAAyB,CAACxB,KAAK,CAAC,CAChD,CACA,GAAIA,KAAK,GAAKyB,SAAS,CAAE,CACvB,MAAO,CAAAnB,MAAM,CAACoB,4BAA4B,CAAC,CAAC,CAC9C,CACA,GAAI1B,KAAK,GAAK,IAAI,CAAE,CAClB,MAAO,CAAAM,MAAM,CAACqB,uBAAuB,CAAC,CAAC,CACzC,CACA,MAAO,CAAArB,MAAM,CAACc,mBAAmB,CAACpB,KAAK,CAAEyB,SAAS,CAAC,CACrD,CACA,MAAO,CAAApB,cAAc,CAACL,KAAK,CAAC,CAC9B\\\",\\\"ignoreList\\\":[]}\"\n};\nvar makeShareableCloneOnUIRecursiveLEGACY = function makeShareableCloneOnUIRecursiveLEGACY_serializableJs9Factory(_ref13) {\n  var _worklet_10155338524513_init_data = _ref13._worklet_10155338524513_init_data,\n    SHOULD_BE_USE_WEB = _ref13.SHOULD_BE_USE_WEB,\n    isHostObject = _ref13.isHostObject,\n    isRemoteFunction = _ref13.isRemoteFunction;\n  var _e = [new global.Error(), -4, -27];\n  var makeShareableCloneOnUIRecursiveLEGACY = function makeShareableCloneOnUIRecursiveLEGACY(value) {\n    if (SHOULD_BE_USE_WEB) {\n      return value;\n    }\n    function cloneRecursive(value) {\n      if (typeof value === 'object' && value !== null || typeof value === 'function') {\n        if (isHostObject(value)) {\n          return global._createSerializableHostObject(value);\n        }\n        if (isRemoteFunction(value)) {\n          return value.__remoteFunction;\n        }\n        if (Array.isArray(value)) {\n          return global._createSerializableArray(value.map(cloneRecursive));\n        }\n        if (value.__synchronizableRef) {\n          return global._createSerializableSynchronizable(value);\n        }\n        var toAdapt = {};\n        for (var _ref14 of Object.entries(value)) {\n          var _ref15 = _slicedToArray(_ref14, 2);\n          var key = _ref15[0];\n          var element = _ref15[1];\n          toAdapt[key] = cloneRecursive(element);\n        }\n        return global._createSerializable(toAdapt, value);\n      }\n      if (typeof value === 'string') {\n        return global._createSerializableString(value);\n      }\n      if (typeof value === 'number') {\n        return global._createSerializableNumber(value);\n      }\n      if (typeof value === 'boolean') {\n        return global._createSerializableBoolean(value);\n      }\n      if (typeof value === 'bigint') {\n        return global._createSerializableBigInt(value);\n      }\n      if (value === undefined) {\n        return global._createSerializableUndefined();\n      }\n      if (value === null) {\n        return global._createSerializableNull();\n      }\n      return global._createSerializable(value, undefined);\n    }\n    return cloneRecursive(value);\n  };\n  makeShareableCloneOnUIRecursiveLEGACY.__closure = {\n    SHOULD_BE_USE_WEB: SHOULD_BE_USE_WEB,\n    isHostObject: isHostObject,\n    isRemoteFunction: isRemoteFunction\n  };\n  makeShareableCloneOnUIRecursiveLEGACY.__workletHash = 10155338524513;\n  makeShareableCloneOnUIRecursiveLEGACY.__pluginVersion = \"0.5.2\";\n  makeShareableCloneOnUIRecursiveLEGACY.__initData = _worklet_10155338524513_init_data;\n  makeShareableCloneOnUIRecursiveLEGACY.__stackDetails = _e;\n  return makeShareableCloneOnUIRecursiveLEGACY;\n}({\n  _worklet_10155338524513_init_data: _worklet_10155338524513_init_data,\n  SHOULD_BE_USE_WEB: SHOULD_BE_USE_WEB,\n  isHostObject: isHostObject,\n  isRemoteFunction: isRemoteFunction\n});\nexport var makeShareableCloneOnUIRecursive = globalThis._WORKLETS_BUNDLE_MODE ? createSerializable : makeShareableCloneOnUIRecursiveLEGACY;\nfunction makeShareableJS(value) {\n  return value;\n}\nvar _worklet_14001869597486_init_data = {\n  code: \"function serializableJs10(){const{value}=this.__closure;return value;}\",\n  location: \"C:\\\\Users\\\\asus\\\\Desktop\\\\V.E.T\\\\node_modules\\\\react-native-worklets\\\\lib\\\\module\\\\serializable.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"serializableJs10\\\",\\\"value\\\",\\\"__closure\\\"],\\\"sources\\\":[\\\"C:/Users/asus/Desktop/V.E.T/node_modules/react-native-worklets/lib/module/serializable.js\\\"],\\\"mappings\\\":\\\"AAsiBY,SAAAA,gBAAMA,CAAA,QAAAC,KAAA,OAAAC,SAAA,CAGZ,MAAO,CAAAD,KAAK,CACd\\\",\\\"ignoreList\\\":[]}\"\n};\nfunction makeShareableNative(value) {\n  if (serializableMappingCache.get(value)) {\n    return value;\n  }\n  var handle = createSerializable({\n    __init: function serializableJs10Factory(_ref16) {\n      var _worklet_14001869597486_init_data = _ref16._worklet_14001869597486_init_data,\n        value = _ref16.value;\n      var _e = [new global.Error(), -2, -27];\n      var serializableJs10 = function serializableJs10() {\n        return value;\n      };\n      serializableJs10.__closure = {\n        value: value\n      };\n      serializableJs10.__workletHash = 14001869597486;\n      serializableJs10.__pluginVersion = \"0.5.2\";\n      serializableJs10.__initData = _worklet_14001869597486_init_data;\n      serializableJs10.__stackDetails = _e;\n      return serializableJs10;\n    }({\n      _worklet_14001869597486_init_data: _worklet_14001869597486_init_data,\n      value: value\n    })\n  });\n  serializableMappingCache.set(value, handle);\n  return value;\n}\nexport var makeShareable = SHOULD_BE_USE_WEB ? makeShareableJS : makeShareableNative;","map":{"version":3,"names":["_slicedToArray","registerWorkletStackDetails","isSynchronizable","logger","SHOULD_BE_USE_WEB","serializableMappingCache","serializableMappingFlag","jsVersion","isWorkletFunction","WorkletsError","WorkletsModule","MAGIC_KEY","_worklet_12782560500969_init_data","code","location","sourceMap","isHostObject","isHostObject_serializableJs1Factory","_ref","_e","global","Error","value","__closure","__workletHash","__pluginVersion","__initData","__stackDetails","isSerializableRef","_worklet_10518649607857_init_data","isPlainJSObject","isPlainJSObject_serializableJs2Factory","_ref2","object","Object","getPrototypeOf","prototype","isTurboModuleLike","getFromCache","cached","get","_worklet_10679603231779_init_data","INACCESSIBLE_OBJECT","__init","serializableJs3Factory","_ref3","serializableJs3","Proxy","_","prop","String","set","VALID_ARRAY_VIEWS_NAMES","DETECT_CYCLIC_OBJECT_DEPTH_THRESHOLD","processedObjectAtThresholdDepth","createSerializableWeb","createSerializableNative","shouldPersistRemote","arguments","length","undefined","depth","detectCyclicObject","isObject","isFunction","cloneString","cloneNumber","cloneBoolean","cloneBigInt","cloneUndefined","cloneNull","clonePrimitive","Array","isArray","cloneArray","globalThis","_WORKLETS_BUNDLE_MODE","__bundleData","cloneImport","cloneRemoteFunction","cloneTurboModuleLike","cloneHostObject","cloneInitializer","__workletContextObjectFactory","cloneContextObject","cloneWorklet","cloneSynchronizable","clonePlainJSObject","Set","cloneSet","Map","cloneMap","RegExp","cloneRegExp","cloneError","ArrayBuffer","cloneArrayBuffer","isView","cloneArrayBufferView","inaccessibleObject","imported","source","require","resolveWeak","createSerializable","createSerializableString","createSerializableNumber","createSerializableBoolean","createSerializableBigInt","createSerializableUndefined","createSerializableNull","cloneObjectProperties","clonedProps","_ref4","entries","_ref5","key","element","createSerializableInitializer","clonedElements","map","clone","createSerializableArray","freezeObjectInDev","createSerializableFunction","createSerializableHostObject","__DEV__","babelVersion","getWorkletCode","createSerializableWorklet","proto","createSerializableTurboModuleLike","_worklet_6111457967290_init_data","workletContextObjectFactory","handle","serializableJs4Factory","_ref6","serializableJs4","createSerializableObject","clonedKeys","clonedValues","_ref7","_ref8","push","createSerializableMap","createSerializableSet","_worklet_15891395326778_init_data","pattern","flags","serializableJs5Factory","_ref9","serializableJs5","_worklet_15256067994573_init_data","name","message","stack","serializableJs6Factory","_ref0","serializableJs6","error","_worklet_2505771972296_init_data","buffer","typeName","constructor","serializableJs7Factory","_ref1","serializableJs7","includes","_value$__bundleData","createSerializableImport","WORKLET_CODE_THRESHOLD","_value$__initData","substring","_worklet_12661863896384_init_data","isRemoteFunction","isRemoteFunction_serializableJs8Factory","_ref10","__remoteFunction","forEach","_ref11","_ref12","descriptor","getOwnPropertyDescriptor","configurable","defineProperty","warn","preventExtensions","_worklet_10155338524513_init_data","makeShareableCloneOnUIRecursiveLEGACY","makeShareableCloneOnUIRecursiveLEGACY_serializableJs9Factory","_ref13","cloneRecursive","_createSerializableHostObject","_createSerializableArray","__synchronizableRef","_createSerializableSynchronizable","toAdapt","_ref14","_ref15","_createSerializable","_createSerializableString","_createSerializableNumber","_createSerializableBoolean","_createSerializableBigInt","_createSerializableUndefined","_createSerializableNull","makeShareableCloneOnUIRecursive","makeShareableJS","_worklet_14001869597486_init_data","makeShareableNative","serializableJs10Factory","_ref16","serializableJs10","makeShareable"],"sources":["C:\\Users\\asus\\Desktop\\V.E.T\\node_modules\\react-native-worklets\\src\\serializable.ts"],"sourcesContent":["'use strict';\nimport { registerWorkletStackDetails } from './errors';\nimport { isSynchronizable } from './isSynchronizable';\nimport { logger } from './logger';\nimport { SHOULD_BE_USE_WEB } from './PlatformChecker';\nimport {\n  serializableMappingCache,\n  serializableMappingFlag,\n} from './serializableMappingCache';\nimport type { Synchronizable } from './synchronizable';\nimport { jsVersion } from './utils/jsVersion';\nimport { isWorkletFunction } from './workletFunction';\nimport { WorkletsError } from './WorkletsError';\nimport { WorkletsModule } from './WorkletsModule';\nimport type {\n  FlatSerializableRef,\n  SerializableRef,\n  WorkletFunction,\n  WorkletImport,\n} from './workletTypes';\n\n// for web and jest environments this file provides a stub implementation\n// where no serializable references are used. Instead, the objects themselves are used\n// instead of serializable references, because of the fact that we don't have to deal with\n// running the code on separate VMs.\n\nconst MAGIC_KEY = 'REANIMATED_MAGIC_KEY';\n\nfunction isHostObject(value: NonNullable<object>) {\n  'worklet';\n  // We could use JSI to determine whether an object is a host object, however\n  // the below workaround works well and is way faster than an additional JSI call.\n  // We use the fact that host objects have broken implementation of `hasOwnProperty`\n  // and hence return true for all `in` checks regardless of the key we ask for.\n  return MAGIC_KEY in value;\n}\n\nexport function isSerializableRef(value: unknown): value is SerializableRef {\n  return (\n    typeof value === 'object' && value !== null && '__serializableRef' in value\n  );\n}\n\nfunction isPlainJSObject(object: object): object is Record<string, unknown> {\n  'worklet';\n  return Object.getPrototypeOf(object) === Object.prototype;\n}\n\nfunction isTurboModuleLike(object: object): object is Record<string, unknown> {\n  return isHostObject(Object.getPrototypeOf(object));\n}\n\nfunction getFromCache(value: object) {\n  const cached = serializableMappingCache.get(value);\n  if (cached === serializableMappingFlag) {\n    // This means that `value` was already a clone and we should return it as is.\n    return value;\n  }\n  return cached;\n}\n\n// The below object is used as a replacement for objects that cannot be transferred\n// as serializable values. In createSerializable we detect if an object is of\n// a plain Object.prototype and only allow such objects to be transferred. This lets\n// us avoid all sorts of react internals from leaking into the UI runtime. To make it\n// possible to catch errors when someone actually tries to access such object on the UI\n// runtime, we use the below Proxy object which is instantiated on the UI runtime and\n// throws whenever someone tries to access its fields.\nconst INACCESSIBLE_OBJECT = {\n  __init: () => {\n    'worklet';\n    return new Proxy(\n      {},\n      {\n        get: (_: unknown, prop: string | symbol) => {\n          if (\n            prop === '_isReanimatedSharedValue' ||\n            prop === '__remoteFunction'\n          ) {\n            // not very happy about this check here, but we need to allow for\n            // \"inaccessible\" objects to be tested with isSerializableRef check\n            // as it is being used in the mappers when extracting inputs recursively\n            // as well as with isRemoteFunction when cloning objects recursively.\n            // Apparently we can't check if a key exists there as HostObjects always\n            // return true for such tests, so the only possibility for us is to\n            // actually access that key and see if it is set to true. We therefore\n            // need to allow for this key to be accessed here.\n            return false;\n          }\n          throw new WorkletsError(\n            `Trying to access property \\`${String(\n              prop\n            )}\\` of an object which cannot be sent to the UI runtime.`\n          );\n        },\n        set: () => {\n          throw new WorkletsError(\n            'Trying to write to an object which cannot be sent to the UI runtime.'\n          );\n        },\n      }\n    );\n  },\n};\n\nconst VALID_ARRAY_VIEWS_NAMES = [\n  'Int8Array',\n  'Uint8Array',\n  'Uint8ClampedArray',\n  'Int16Array',\n  'Uint16Array',\n  'Int32Array',\n  'Uint32Array',\n  'Float32Array',\n  'Float64Array',\n  'BigInt64Array',\n  'BigUint64Array',\n  'DataView',\n];\n\nconst DETECT_CYCLIC_OBJECT_DEPTH_THRESHOLD = 30;\n// Below variable stores object that we process in createSerializable at the specified depth.\n// We use it to check if later on the function reenters with the same object\nlet processedObjectAtThresholdDepth: unknown;\n\nfunction createSerializableWeb<T>(value: T): SerializableRef<T> {\n  return value as SerializableRef<T>;\n}\n\nfunction createSerializableNative<T>(\n  value: T,\n  shouldPersistRemote = false,\n  depth = 0\n): SerializableRef<T> {\n  detectCyclicObject(value, depth);\n\n  const isObject = typeof value === 'object';\n  const isFunction = typeof value === 'function';\n\n  if (typeof value === 'string') {\n    return cloneString(value) as SerializableRef<T>;\n  }\n\n  if (typeof value === 'number') {\n    return cloneNumber(value) as SerializableRef<T>;\n  }\n\n  if (typeof value === 'boolean') {\n    return cloneBoolean(value) as SerializableRef<T>;\n  }\n\n  if (typeof value === 'bigint') {\n    return cloneBigInt(value) as SerializableRef<T>;\n  }\n\n  if (value === undefined) {\n    return cloneUndefined() as SerializableRef<T>;\n  }\n\n  if (value === null) {\n    return cloneNull() as SerializableRef<T>;\n  }\n\n  if ((!isObject && !isFunction) || value === null) {\n    return clonePrimitive(value, shouldPersistRemote);\n  }\n\n  const cached = getFromCache(value);\n  if (cached !== undefined) {\n    return cached as SerializableRef<T>;\n  }\n\n  if (Array.isArray(value)) {\n    return cloneArray(value, shouldPersistRemote, depth);\n  }\n  if (\n    globalThis._WORKLETS_BUNDLE_MODE &&\n    isFunction &&\n    (value as WorkletImport).__bundleData\n  ) {\n    return cloneImport(value as WorkletImport) as SerializableRef<T>;\n  }\n  if (isFunction && !isWorkletFunction(value)) {\n    return cloneRemoteFunction(value);\n  }\n  // RN has introduced a new representation of TurboModules as a JS object whose prototype is the host object\n  // More details: https://github.com/facebook/react-native/blob/main/packages/react-native/ReactCommon/react/nativemodule/core/ReactCommon/TurboModuleBinding.cpp#L182\n  if (isTurboModuleLike(value)) {\n    return cloneTurboModuleLike(value, shouldPersistRemote, depth);\n  }\n  if (isHostObject(value)) {\n    return cloneHostObject(value);\n  }\n  if (isPlainJSObject(value) && value.__init) {\n    return cloneInitializer(\n      value,\n      shouldPersistRemote,\n      depth\n    ) as SerializableRef<T>;\n  }\n  if (isPlainJSObject(value) && value.__workletContextObjectFactory) {\n    return cloneContextObject(value);\n  }\n  if ((isPlainJSObject(value) || isFunction) && isWorkletFunction(value)) {\n    return cloneWorklet(value, shouldPersistRemote, depth);\n  }\n  if (isSynchronizable(value)) {\n    return cloneSynchronizable(value) as SerializableRef<T>;\n  }\n  if (isPlainJSObject(value) || isFunction) {\n    return clonePlainJSObject(value, shouldPersistRemote, depth);\n  }\n  if (value instanceof Set) {\n    return cloneSet(value);\n  }\n  if (value instanceof Map) {\n    return cloneMap(value);\n  }\n  if (value instanceof RegExp) {\n    return cloneRegExp(value);\n  }\n  if (value instanceof Error) {\n    return cloneError(value);\n  }\n  if (value instanceof ArrayBuffer) {\n    return cloneArrayBuffer(value, shouldPersistRemote);\n  }\n  if (ArrayBuffer.isView(value)) {\n    // typed array (e.g. Int32Array, Uint8ClampedArray) or DataView\n    return cloneArrayBufferView(value);\n  }\n  return inaccessibleObject(value);\n}\n\nif (globalThis._WORKLETS_BUNDLE_MODE) {\n  // TODO: Do it programatically.\n  createSerializableNative.__bundleData = {\n    imported: 'createSerializable',\n    // @ts-expect-error resolveWeak is defined by Metro\n    source: require.resolveWeak('./index'),\n  };\n}\n\ninterface CreateSerializable {\n  <T>(value: T): SerializableRef<T>;\n  <T>(\n    value: T,\n    shouldPersistRemote: boolean,\n    depth: number\n  ): SerializableRef<T>;\n}\n\nexport const createSerializable: CreateSerializable = SHOULD_BE_USE_WEB\n  ? createSerializableWeb\n  : createSerializableNative;\n\nfunction detectCyclicObject(value: unknown, depth: number) {\n  if (depth >= DETECT_CYCLIC_OBJECT_DEPTH_THRESHOLD) {\n    // if we reach certain recursion depth we suspect that we are dealing with a cyclic object.\n    // this type of objects are not supported and cannot be transferred as serializable, so we\n    // implement a simple detection mechanism that remembers the value at a given depth and\n    // tests whether we try reenter this method later on with the same value. If that happens\n    // we throw an appropriate error.\n    if (depth === DETECT_CYCLIC_OBJECT_DEPTH_THRESHOLD) {\n      processedObjectAtThresholdDepth = value;\n    } else if (value === processedObjectAtThresholdDepth) {\n      throw new WorkletsError(\n        'Trying to convert a cyclic object to a serializable. This is not supported.'\n      );\n    }\n  } else {\n    processedObjectAtThresholdDepth = undefined;\n  }\n}\n\nfunction clonePrimitive<T>(\n  value: T,\n  shouldPersistRemote: boolean\n): SerializableRef<T> {\n  return WorkletsModule.createSerializable(value, shouldPersistRemote);\n}\n\nfunction cloneString(value: string): SerializableRef<string> {\n  return WorkletsModule.createSerializableString(value);\n}\n\nfunction cloneNumber(value: number): SerializableRef<number> {\n  return WorkletsModule.createSerializableNumber(value);\n}\n\nfunction cloneBoolean(value: boolean): SerializableRef<boolean> {\n  return WorkletsModule.createSerializableBoolean(value);\n}\n\nfunction cloneBigInt(value: bigint): SerializableRef<bigint> {\n  return WorkletsModule.createSerializableBigInt(value);\n}\n\nfunction cloneUndefined(): SerializableRef<undefined> {\n  return WorkletsModule.createSerializableUndefined();\n}\n\nfunction cloneNull(): SerializableRef<null> {\n  return WorkletsModule.createSerializableNull();\n}\n\nfunction cloneObjectProperties<T extends object>(\n  value: T,\n  shouldPersistRemote: boolean,\n  depth: number\n): Record<string, unknown> {\n  const clonedProps: Record<string, unknown> = {};\n  for (const [key, element] of Object.entries(value)) {\n    // We don't need to clone __initData field as it contains long strings\n    // representing the worklet code, source map, and location, and we will\n    // serialize/deserialize it once.\n    if (key === '__initData' && clonedProps.__initData !== undefined) {\n      continue;\n    }\n    clonedProps[key] = createSerializable(\n      element,\n      shouldPersistRemote,\n      depth + 1\n    );\n  }\n  return clonedProps;\n}\n\nfunction cloneInitializer(\n  value: object,\n  shouldPersistRemote = false,\n  depth = 0\n): SerializableRef<object> {\n  const clonedProps: Record<string, unknown> = cloneObjectProperties(\n    value,\n    shouldPersistRemote,\n    depth\n  );\n  return WorkletsModule.createSerializableInitializer(clonedProps);\n}\n\nfunction cloneArray<T extends unknown[]>(\n  value: T,\n  shouldPersistRemote: boolean,\n  depth: number\n): SerializableRef<T> {\n  const clonedElements = value.map((element) =>\n    createSerializable(element, shouldPersistRemote, depth + 1)\n  );\n  const clone = WorkletsModule.createSerializableArray(\n    clonedElements,\n    shouldPersistRemote\n  ) as SerializableRef<T>;\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  freezeObjectInDev(value);\n  return clone;\n}\n\nfunction cloneRemoteFunction<TArgs extends unknown[], TReturn>(\n  value: (...args: TArgs) => TReturn\n): SerializableRef<TReturn> {\n  const clone = WorkletsModule.createSerializableFunction(value);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  freezeObjectInDev(value);\n  return clone;\n}\n\nfunction cloneHostObject<T extends object>(value: T): SerializableRef<T> {\n  // for host objects we pass the reference to the object as serializable and\n  // then recreate new host object wrapping the same instance on the UI thread.\n  // there is no point of iterating over keys as we do for regular objects.\n  const clone = WorkletsModule.createSerializableHostObject(value);\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  return clone;\n}\n\nfunction cloneWorklet<T extends WorkletFunction>(\n  value: T,\n  shouldPersistRemote: boolean,\n  depth: number\n): SerializableRef<T> {\n  if (__DEV__) {\n    const babelVersion = (value as WorkletFunction).__pluginVersion;\n    if (babelVersion !== undefined && babelVersion !== jsVersion) {\n      throw new WorkletsError(\n        `Mismatch between JavaScript code version and Worklets Babel plugin version (${jsVersion} vs. ${babelVersion}).\n    See \\`https://docs.swmansion.com/react-native-worklets/docs/guides/troubleshooting#mismatch-between-javascript-code-version-and-worklets-babel-plugin-version\\` for more details.\n    Offending code was: \\`${getWorkletCode(value)}\\``\n      );\n    }\n    registerWorkletStackDetails(\n      value.__workletHash,\n      (value as WorkletFunction).__stackDetails!\n    );\n  }\n  if ((value as WorkletFunction).__stackDetails) {\n    // `Error` type of value cannot be copied to the UI thread, so we\n    // remove it after we handled it in dev mode or delete it to ignore it in production mode.\n    // Not removing this would cause an infinite loop in production mode and it just\n    // seems more elegant to handle it this way.\n    delete (value as WorkletFunction).__stackDetails;\n  }\n  const clonedProps: Record<string, unknown> = cloneObjectProperties(\n    value,\n    true,\n    depth\n  );\n  // to save on transferring static __initData field of worklet structure\n  // we request serializable value to persist its UI counterpart. This means\n  // that the __initData field that contains long strings representing the\n  // worklet code, source map, and location, will always be\n  // serialized/deserialized once.\n  clonedProps.__initData = createSerializable(\n    value.__initData,\n    true,\n    depth + 1\n  );\n\n  const clone = WorkletsModule.createSerializableWorklet(\n    clonedProps,\n    // TODO: Check after refactor if we can remove shouldPersistRemote parameter (imho it's redundant here since worklets are always persistent)\n    // retain all worklets\n    true\n  ) as SerializableRef<T>;\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  freezeObjectInDev(value);\n  return clone;\n}\n\n/**\n * TurboModuleLike objects are JS objects that have a TurboModule as their\n * prototype.\n */\nfunction cloneTurboModuleLike<T extends object>(\n  value: T,\n  shouldPersistRemote: boolean,\n  depth: number\n): SerializableRef<T> {\n  const proto = Object.getPrototypeOf(value);\n  const clonedProps = cloneObjectProperties(value, shouldPersistRemote, depth);\n  const clone = WorkletsModule.createSerializableTurboModuleLike(\n    clonedProps,\n    proto\n  ) as SerializableRef<T>;\n  return clone;\n}\n\nfunction cloneContextObject<T extends object>(value: T): SerializableRef<T> {\n  const workletContextObjectFactory = (value as Record<string, unknown>)\n    .__workletContextObjectFactory as () => T;\n  const handle = cloneInitializer({\n    __init: () => {\n      'worklet';\n      return workletContextObjectFactory();\n    },\n  });\n  serializableMappingCache.set(value, handle);\n  return handle as SerializableRef<T>;\n}\n\nfunction clonePlainJSObject<T extends object>(\n  value: T,\n  shouldPersistRemote: boolean,\n  depth: number\n): SerializableRef<T> {\n  const clonedProps: Record<string, unknown> = cloneObjectProperties(\n    value,\n    shouldPersistRemote,\n    depth\n  );\n  const clone = WorkletsModule.createSerializableObject(\n    clonedProps,\n    shouldPersistRemote,\n    value\n  ) as SerializableRef<T>;\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  freezeObjectInDev(value);\n  return clone;\n}\n\nfunction cloneMap<T extends Map<unknown, unknown>>(\n  value: T\n): SerializableRef<T> {\n  const clonedKeys: unknown[] = [];\n  const clonedValues: unknown[] = [];\n  for (const [key, element] of value.entries()) {\n    clonedKeys.push(createSerializable(key));\n    clonedValues.push(createSerializable(element));\n  }\n  const clone = WorkletsModule.createSerializableMap(\n    clonedKeys,\n    clonedValues\n  ) as SerializableRef<T>;\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  freezeObjectInDev(value);\n  return clone;\n}\n\nfunction cloneSet<T extends Set<unknown>>(value: T): SerializableRef<T> {\n  const clonedElements: unknown[] = [];\n  for (const element of value) {\n    clonedElements.push(createSerializable(element));\n  }\n  const clone = WorkletsModule.createSerializableSet(\n    clonedElements\n  ) as SerializableRef<T>;\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  freezeObjectInDev(value);\n  return clone;\n}\n\nfunction cloneRegExp<T extends RegExp>(value: T): SerializableRef<T> {\n  const pattern = value.source;\n  const flags = value.flags;\n  const handle = cloneInitializer({\n    __init: () => {\n      'worklet';\n      return new RegExp(pattern, flags);\n    },\n  }) as unknown as SerializableRef<T>;\n  serializableMappingCache.set(value, handle);\n\n  return handle;\n}\n\nfunction cloneError<T extends Error>(value: T): SerializableRef<T> {\n  const { name, message, stack } = value;\n  const handle = cloneInitializer({\n    __init: () => {\n      'worklet';\n      // eslint-disable-next-line reanimated/use-worklets-error\n      const error = new Error();\n      error.name = name;\n      error.message = message;\n      error.stack = stack;\n      return error;\n    },\n  });\n  serializableMappingCache.set(value, handle);\n  return handle as unknown as SerializableRef<T>;\n}\n\nfunction cloneArrayBuffer<T extends ArrayBuffer>(\n  value: T,\n  shouldPersistRemote: boolean\n): SerializableRef<T> {\n  const clone = WorkletsModule.createSerializable(\n    value,\n    shouldPersistRemote,\n    value\n  );\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  return clone;\n}\n\nfunction cloneArrayBufferView<T extends ArrayBufferView>(\n  value: T\n): SerializableRef<T> {\n  const buffer = value.buffer;\n  const typeName = value.constructor.name;\n  const handle = cloneInitializer({\n    __init: () => {\n      'worklet';\n      if (!VALID_ARRAY_VIEWS_NAMES.includes(typeName)) {\n        throw new WorkletsError(`Invalid array view name \\`${typeName}\\`.`);\n      }\n      const constructor = global[typeName as keyof typeof global];\n      if (constructor === undefined) {\n        throw new WorkletsError(`Constructor for \\`${typeName}\\` not found.`);\n      }\n      return new constructor(buffer);\n    },\n  }) as unknown as SerializableRef<T>;\n  serializableMappingCache.set(value, handle);\n\n  return handle;\n}\n\nfunction cloneSynchronizable<TValue>(\n  value: Synchronizable<TValue>\n): SerializableRef<TValue> {\n  serializableMappingCache.set(value);\n  return value;\n}\n\nfunction cloneImport<TValue extends WorkletImport>(\n  value: TValue\n): SerializableRef<TValue> {\n  const { source, imported } = value.__bundleData;\n  const clone = WorkletsModule.createSerializableImport(source, imported);\n\n  serializableMappingCache.set(value, clone);\n  serializableMappingCache.set(clone);\n\n  return clone as SerializableRef<TValue>;\n}\n\nfunction inaccessibleObject<T extends object>(value: T): SerializableRef<T> {\n  // This is reached for object types that are not of plain Object.prototype.\n  // We don't support such objects from being transferred as serializables to\n  // the UI runtime and hence we replace them with \"inaccessible object\"\n  // which is implemented as a Proxy object that throws on any attempt\n  // of accessing its fields. We argue that such objects can sometimes leak\n  // as attributes of objects being captured by worklets but should never\n  // be used on the UI runtime regardless. If they are being accessed, the user\n  // will get an appropriate error message.\n  const clone = createSerializable<T>(INACCESSIBLE_OBJECT as T);\n  serializableMappingCache.set(value, clone);\n  return clone;\n}\n\nconst WORKLET_CODE_THRESHOLD = 255;\n\nfunction getWorkletCode(value: WorkletFunction) {\n  const code = value?.__initData?.code;\n  if (!code) {\n    return 'unknown';\n  }\n  if (code.length > WORKLET_CODE_THRESHOLD) {\n    return `${code.substring(0, WORKLET_CODE_THRESHOLD)}...`;\n  }\n  return code;\n}\n\ntype RemoteFunction<T> = {\n  __remoteFunction: FlatSerializableRef<T>;\n};\n\nfunction isRemoteFunction<T>(value: {\n  __remoteFunction?: unknown;\n}): value is RemoteFunction<T> {\n  'worklet';\n  return !!value.__remoteFunction;\n}\n\n/**\n * We freeze\n *\n * - Arrays,\n * - Remote functions,\n * - Plain JS objects,\n *\n * That are transformed to a serializable with a meaningful warning. This should\n * help detect issues when someone modifies data after it's been converted.\n * Meaning that they may be doing a faulty assumption in their code expecting\n * that the updates are going to automatically propagate to the object sent to\n * the UI thread. If the user really wants some objects to be mutable they\n * should use shared values instead.\n */\nfunction freezeObjectInDev<T extends object>(value: T) {\n  if (!__DEV__) {\n    return;\n  }\n  Object.entries(value).forEach(([key, element]) => {\n    const descriptor = Object.getOwnPropertyDescriptor(value, key)!;\n    if (!descriptor.configurable) {\n      return;\n    }\n    Object.defineProperty(value, key, {\n      get() {\n        return element;\n      },\n      set() {\n        logger.warn(\n          `Tried to modify key \\`${key}\\` of an object which has been already passed to a worklet. See\n        https://docs.swmansion.com/react-native-reanimated/docs/guides/troubleshooting#tried-to-modify-key-of-an-object-which-has-been-converted-to-a-serializable\n        for more details.`\n        );\n      },\n    });\n  });\n  Object.preventExtensions(value);\n}\n\nfunction makeShareableCloneOnUIRecursiveLEGACY<T>(\n  value: T\n): FlatSerializableRef<T> {\n  'worklet';\n  if (SHOULD_BE_USE_WEB) {\n    // @ts-ignore web is an interesting place where we don't run a secondary VM on the UI thread\n    // see more details in the comment where USE_STUB_IMPLEMENTATION is defined.\n    return value;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  function cloneRecursive(value: T): FlatSerializableRef<T> {\n    if (\n      (typeof value === 'object' && value !== null) ||\n      typeof value === 'function'\n    ) {\n      if (isHostObject(value)) {\n        // We call `_createSerializableClone` to wrap the provided HostObject\n        // inside SerializableJSRef.\n        return global._createSerializableHostObject(\n          value\n        ) as FlatSerializableRef<T>;\n      }\n      if (isRemoteFunction<T>(value)) {\n        // RemoteFunctions are created by us therefore they are\n        // a Serializable out of the box and there is no need to\n        // call `_createSerializableClone`.\n        return value.__remoteFunction;\n      }\n      if (Array.isArray(value)) {\n        return global._createSerializableArray(\n          value.map(cloneRecursive)\n        ) as FlatSerializableRef<T>;\n      }\n      if ((value as Record<string, unknown>).__synchronizableRef) {\n        return global._createSerializableSynchronizable(\n          value\n        ) as FlatSerializableRef<T>;\n      }\n      const toAdapt: Record<string, FlatSerializableRef<T>> = {};\n      for (const [key, element] of Object.entries(value)) {\n        toAdapt[key] = cloneRecursive(element);\n      }\n      return global._createSerializable(\n        toAdapt,\n        value\n      ) as FlatSerializableRef<T>;\n    }\n\n    if (typeof value === 'string') {\n      return global._createSerializableString(value);\n    }\n\n    if (typeof value === 'number') {\n      return global._createSerializableNumber(value);\n    }\n\n    if (typeof value === 'boolean') {\n      return global._createSerializableBoolean(value);\n    }\n\n    if (typeof value === 'bigint') {\n      return global._createSerializableBigInt(value);\n    }\n\n    if (value === undefined) {\n      return global._createSerializableUndefined();\n    }\n\n    if (value === null) {\n      return global._createSerializableNull();\n    }\n\n    return global._createSerializable(value, undefined);\n  }\n  return cloneRecursive(value);\n}\n\n/** @deprecated This function is no longer supported. */\nexport const makeShareableCloneOnUIRecursive = (\n  globalThis._WORKLETS_BUNDLE_MODE\n    ? createSerializable\n    : makeShareableCloneOnUIRecursiveLEGACY\n) as typeof makeShareableCloneOnUIRecursiveLEGACY;\n\nfunction makeShareableJS<T>(value: T): T {\n  return value;\n}\n\nfunction makeShareableNative<T extends object>(value: T): T {\n  if (serializableMappingCache.get(value)) {\n    return value;\n  }\n  const handle = createSerializable({\n    __init: () => {\n      'worklet';\n      return value;\n    },\n  });\n  serializableMappingCache.set(value, handle);\n  return value;\n}\n\n/**\n * This function creates a value on UI with persistent state - changes to it on\n * the UI thread will be seen by all worklets. Use it when you want to create a\n * value that is read and written only on the UI thread.\n */\n/** @deprecated This function is no longer supported. */\nexport const makeShareable = SHOULD_BE_USE_WEB\n  ? makeShareableJS\n  : makeShareableNative;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}