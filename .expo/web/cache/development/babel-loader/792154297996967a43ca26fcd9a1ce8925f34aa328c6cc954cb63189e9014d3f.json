{"ast":null,"code":"'use strict';\n\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _excluded = [\"animationTimingFunction\"];\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { ReanimatedError } from \"../../../../common\";\nimport { PERCENTAGE_REGEX } from \"../../../constants\";\nimport { isDefined, isNumber } from \"../../../utils\";\nimport { normalizeTimingFunction } from \"../common\";\nexport var ERROR_MESSAGES = {\n  invalidOffsetType: function invalidOffsetType(selector) {\n    return `Invalid keyframe selector \"${selector}\". Only numbers, percentages, \"from\", and \"to\" are supported.`;\n  },\n  invalidOffsetRange: function invalidOffsetRange(selector) {\n    return `Invalid keyframe selector \"${selector}\". Expected a number between 0 and 1 or a percentage between 0% and 100%.`;\n  }\n};\nfunction normalizeKeyframeSelector(keyframeSelector) {\n  var selectors = typeof keyframeSelector === 'string' ? keyframeSelector.split(',').map(function (k) {\n    return k.trim();\n  }) : [keyframeSelector];\n  var offsets = selectors.map(function (selector) {\n    if (selector === 'from') {\n      return 0;\n    }\n    if (selector === 'to') {\n      return 1;\n    }\n    var offset;\n    if (typeof selector === 'number' || !isNaN(+selector)) {\n      offset = +selector;\n    } else if (PERCENTAGE_REGEX.test(selector)) {\n      offset = parseFloat(selector) / 100;\n    }\n    if (!isNumber(offset)) {\n      throw new ReanimatedError(ERROR_MESSAGES.invalidOffsetType(selector));\n    }\n    if (offset < 0 || offset > 1) {\n      throw new ReanimatedError(ERROR_MESSAGES.invalidOffsetRange(selector));\n    }\n    return offset;\n  });\n  return offsets;\n}\nfunction processKeyframes(keyframes, styleBuilder) {\n  return Object.entries(keyframes).flatMap(function (_ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n      selector = _ref3[0],\n      _ref3$ = _ref3[1],\n      _ref = _ref3$ === void 0 ? {} : _ref3$;\n    var _ref$animationTimingF = _ref.animationTimingFunction,\n      animationTimingFunction = _ref$animationTimingF === void 0 ? undefined : _ref$animationTimingF,\n      style = _objectWithoutProperties(_ref, _excluded);\n    var normalizedStyle = styleBuilder.buildFrom(style);\n    if (!normalizedStyle) {\n      return [];\n    }\n    return normalizeKeyframeSelector(selector).map(function (offset) {\n      return {\n        offset: offset,\n        style: normalizedStyle,\n        timingFunction: animationTimingFunction\n      };\n    });\n  }).sort(function (a, b) {\n    return a.offset - b.offset;\n  }).reduce(function (acc, keyframe) {\n    var lastKeyframe = acc[acc.length - 1];\n    if (lastKeyframe && lastKeyframe.offset === keyframe.offset) {\n      lastKeyframe.style = _objectSpread(_objectSpread({}, lastKeyframe.style), keyframe.style);\n      lastKeyframe.timingFunction = keyframe.timingFunction;\n    } else {\n      acc.push(keyframe);\n    }\n    return acc;\n  }, []);\n}\nfunction processStyleProperties(offset, style, keyframeStyle, styleBuilder) {\n  Object.entries(style).forEach(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n      property = _ref5[0],\n      value = _ref5[1];\n    if (!isDefined(value)) {\n      return;\n    }\n    if (typeof value === 'object') {\n      if (!Array.isArray(value) || styleBuilder.isSeparatelyInterpolatedArrayProperty(property)) {\n        if (!keyframeStyle[property]) {\n          keyframeStyle[property] = Array.isArray(value) ? [] : {};\n        }\n        processStyleProperties(offset, value, keyframeStyle[property], styleBuilder);\n        return;\n      }\n    }\n    if (!keyframeStyle[property]) {\n      keyframeStyle[property] = [];\n    }\n    keyframeStyle[property].push({\n      offset: offset,\n      value: value\n    });\n  });\n}\nexport function normalizeAnimationKeyframes(keyframes, styleBuilder) {\n  var keyframesStyle = {};\n  var timingFunctions = {};\n  processKeyframes(keyframes, styleBuilder).forEach(function (_ref6) {\n    var offset = _ref6.offset,\n      style = _ref6.style,\n      timingFunction = _ref6.timingFunction;\n    processStyleProperties(offset, style, keyframesStyle, styleBuilder);\n    if (timingFunction && offset < 1) {\n      timingFunctions[offset] = normalizeTimingFunction(timingFunction);\n    }\n  });\n  return {\n    keyframesStyle: keyframesStyle,\n    keyframeTimingFunctions: timingFunctions\n  };\n}","map":{"version":3,"names":["_defineProperty","_objectWithoutProperties","_slicedToArray","_excluded","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","ReanimatedError","PERCENTAGE_REGEX","isDefined","isNumber","normalizeTimingFunction","ERROR_MESSAGES","invalidOffsetType","selector","invalidOffsetRange","normalizeKeyframeSelector","keyframeSelector","selectors","split","map","k","trim","offsets","offset","isNaN","test","parseFloat","processKeyframes","keyframes","styleBuilder","entries","flatMap","_ref2","_ref3","_ref3$","_ref","_ref$animationTimingF","animationTimingFunction","undefined","style","normalizedStyle","buildFrom","timingFunction","sort","a","b","reduce","acc","keyframe","lastKeyframe","processStyleProperties","keyframeStyle","_ref4","_ref5","property","value","Array","isArray","isSeparatelyInterpolatedArrayProperty","normalizeAnimationKeyframes","keyframesStyle","timingFunctions","_ref6","keyframeTimingFunctions"],"sources":["C:\\Users\\asus\\Desktop\\V.E.T\\node_modules\\react-native-reanimated\\src\\css\\native\\normalization\\animation\\keyframes.ts"],"sourcesContent":["'use strict';\nimport { ReanimatedError } from '../../../../common';\nimport type { StyleProps } from '../../../../commonTypes';\nimport { PERCENTAGE_REGEX } from '../../../constants';\nimport type {\n  AnyRecord,\n  CSSAnimationKeyframes,\n  CSSAnimationKeyframeSelector,\n  CSSAnimationTimingFunction,\n} from '../../../types';\nimport { isDefined, isNumber } from '../../../utils';\nimport type { StyleBuilder } from '../../style';\nimport type {\n  NormalizedCSSAnimationKeyframesConfig,\n  NormalizedCSSKeyframesStyle,\n  NormalizedCSSKeyframeTimingFunctions,\n} from '../../types';\nimport { normalizeTimingFunction } from '../common';\n\nexport const ERROR_MESSAGES = {\n  invalidOffsetType: (selector: CSSAnimationKeyframeSelector) =>\n    `Invalid keyframe selector \"${selector}\". Only numbers, percentages, \"from\", and \"to\" are supported.`,\n  invalidOffsetRange: (selector: CSSAnimationKeyframeSelector) =>\n    `Invalid keyframe selector \"${selector}\". Expected a number between 0 and 1 or a percentage between 0% and 100%.`,\n};\n\nfunction normalizeKeyframeSelector(\n  keyframeSelector: CSSAnimationKeyframeSelector\n): number[] {\n  const selectors =\n    typeof keyframeSelector === 'string'\n      ? keyframeSelector.split(',').map((k) => k.trim())\n      : [keyframeSelector];\n\n  const offsets = selectors.map((selector) => {\n    if (selector === 'from') {\n      return 0;\n    }\n    if (selector === 'to') {\n      return 1;\n    }\n\n    let offset: number | undefined;\n\n    if (typeof selector === 'number' || !isNaN(+selector)) {\n      offset = +selector;\n    } else if (PERCENTAGE_REGEX.test(selector)) {\n      offset = parseFloat(selector) / 100;\n    }\n\n    if (!isNumber(offset)) {\n      throw new ReanimatedError(ERROR_MESSAGES.invalidOffsetType(selector));\n    }\n    if (offset < 0 || offset > 1) {\n      throw new ReanimatedError(ERROR_MESSAGES.invalidOffsetRange(selector));\n    }\n\n    return offset;\n  });\n\n  return offsets;\n}\n\ntype ProcessedKeyframes = Array<{\n  offset: number;\n  style: StyleProps;\n  timingFunction?: CSSAnimationTimingFunction;\n}>;\n\nfunction processKeyframes(\n  keyframes: CSSAnimationKeyframes,\n  styleBuilder: StyleBuilder<AnyRecord>\n): ProcessedKeyframes {\n  return Object.entries(keyframes)\n    .flatMap(\n      ([selector, { animationTimingFunction = undefined, ...style } = {}]) => {\n        const normalizedStyle = styleBuilder.buildFrom(style);\n        if (!normalizedStyle) {\n          return [];\n        }\n        return normalizeKeyframeSelector(selector).map((offset) => ({\n          offset,\n          style: normalizedStyle,\n          timingFunction: animationTimingFunction,\n        }));\n      }\n    )\n    .sort((a, b) => a.offset - b.offset)\n    .reduce<ProcessedKeyframes>((acc, keyframe) => {\n      const lastKeyframe = acc[acc.length - 1];\n      if (lastKeyframe && lastKeyframe.offset === keyframe.offset) {\n        lastKeyframe.style = { ...lastKeyframe.style, ...keyframe.style };\n        lastKeyframe.timingFunction = keyframe.timingFunction;\n      } else {\n        acc.push(keyframe);\n      }\n      return acc;\n    }, []);\n}\n\nfunction processStyleProperties<S extends AnyRecord>(\n  offset: number,\n  style: S,\n  keyframeStyle: AnyRecord,\n  styleBuilder: StyleBuilder<AnyRecord>\n) {\n  Object.entries(style).forEach(([property, value]) => {\n    if (!isDefined(value)) {\n      return;\n    }\n\n    if (typeof value === 'object') {\n      if (\n        !Array.isArray(value) ||\n        styleBuilder.isSeparatelyInterpolatedArrayProperty(property)\n      ) {\n        if (!keyframeStyle[property]) {\n          keyframeStyle[property] = Array.isArray(value) ? [] : {};\n        }\n        processStyleProperties(\n          offset,\n          value,\n          keyframeStyle[property],\n          styleBuilder\n        );\n        return;\n      }\n    }\n\n    if (!keyframeStyle[property]) {\n      keyframeStyle[property] = [];\n    }\n    keyframeStyle[property].push({ offset, value });\n  });\n}\n\nexport function normalizeAnimationKeyframes(\n  keyframes: CSSAnimationKeyframes,\n  styleBuilder: StyleBuilder<AnyRecord>\n): NormalizedCSSAnimationKeyframesConfig {\n  const keyframesStyle: NormalizedCSSKeyframesStyle = {};\n  const timingFunctions: NormalizedCSSKeyframeTimingFunctions = {};\n\n  processKeyframes(keyframes, styleBuilder).forEach(\n    ({ offset, style, timingFunction }) => {\n      processStyleProperties(offset, style, keyframesStyle, styleBuilder);\n      if (timingFunction && offset < 1) {\n        timingFunctions[offset] = normalizeTimingFunction(timingFunction);\n      }\n    }\n  );\n\n  return { keyframesStyle, keyframeTimingFunctions: timingFunctions };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}